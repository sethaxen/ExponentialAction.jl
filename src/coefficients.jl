# θ values copied from https://github.com/higham/expmv
# licensed under BSD 2-clause
# Copyright (c) 2010, Awad H. Al-Mohy and Nicholas J. Higham
# All rights reserved.

const THETA_HALF = [
    0.001950584762814904,
    0.07443664887032597,
    0.26645543898559093,
    0.5242048568648412,
    0.8102685142887327,
    1.1082254038421477,
    1.410815126097806,
    1.7149335377126314,
    2.0190270679488944,
    2.3224688613557,
    2.6249213455770715,
    2.9262997778935644,
    3.2265730019101024,
    3.5257837068335576,
    3.823979680852456,
    4.121228354718191,
    4.417592371582696,
    4.7131368584103175,
    5.007920848334743,
    5.302000776432474,
    5.595427583978743,
    5.888248503858167,
    6.180506210016306,
    6.47223984123265,
    6.7634848517636375,
    7.05427364278112,
    7.344635697787662,
    7.63459798213797,
    7.924185098503977,
    8.213419599175262,
    8.502322309993382,
    8.790911896542282,
    9.079205995085596,
    9.36722072360105,
    9.654970979948311,
    9.942470643860055,
    10.22973277006132,
    10.516769562944935,
    10.803591924411872,
    11.090209318889052,
    11.376630596540286,
    11.66286469131698,
    11.948920300133784,
    12.234805443312172,
    12.52052748249999,
    12.80609327504064,
    13.091509221546932,
    13.376781447204248,
    13.661915635662538,
    13.946917272123674,
    14.231791928048837,
    14.516546202522862,
    14.801189876312801,
    15.085739283701036,
    15.370219612064448,
    15.654660889237823,
    15.939083777959906,
    16.223481079455887,
    16.507811763157747,
    16.79201951085201,
    17.076064688612032,
    17.35994292272103,
    17.64367730032713,
    17.927297433730974,
    18.210825060557546,
    18.494271865951433,
    18.777643351914264,
    19.06094250390853,
    19.344171544810173,
    19.627332478841733,
    19.910427209707148,
    20.19345756148449,
    20.47642528440919,
    20.759332058870104,
    21.042179499053244,
    21.32496915634898,
    21.60770252254433,
    21.890381032816297,
    22.1730060685409,
    22.455578959931216,
    22.738100988516745,
    23.020573389475285,
    23.30299735382772,
    23.58537403050521,
    23.867704538597092,
    24.149989944074235,
    24.43223127470827,
    24.714429529518352,
    24.996585674173957,
    25.278700642569085,
    25.5607753385361,
    25.842810638173965,
    26.12480739405124,
    26.406766444561864,
    26.68868863646359,
    26.97057487910937,
    27.25242627039594,
    27.534244375298467,
    27.81603180887223,
    28.097793386876763,
]

const THETA_SINGLE = [
    1.1920927998154304e-7,
    0.0005978858893805217,
    0.011233864735286708,
    0.05116619363445085,
    0.13084871645994703,
    0.24952893228466977,
    0.40145824235104804,
    0.5800524627688768,
    0.779511337435803,
    0.9951840790004457,
    1.2234795424241427,
    1.4616615072090335,
    1.7076485296087012,
    1.959850585959898,
    2.2170443949747205,
    2.4782808775219713,
    2.7428171126987797,
    3.0100663628176343,
    3.279561212635997,
    3.5509262147064953,
    3.823857425450966,
    4.098106972191506,
    4.3734713118405,
    4.649782224100758,
    4.926899843755911,
    5.204707228012361,
    5.483106087658634,
    5.762013408447769,
    6.041358758192571,
    6.321082126301961,
    6.601132179501162,
    6.8814648452097185,
    7.162042154487758,
    7.4428312919365975,
    7.723803811553991,
    8.004934986436286,
    8.286203267002167,
    8.567589827662578,
    8.849078185923954,
    9.13065388109011,
    9.412304202219431,
    9.694017956963032,
    9.975785274470699,
    10.257597436797516,
    10.539446734242194,
    10.821326340852181,
    11.103230206980713,
    11.385152966309168,
    11.667089855178881,
    11.949036642429446,
    12.230989568231498,
    12.51294529064492,
    12.7949008388429,
    13.07685357212606,
    13.35880114398722,
    13.64074147050525,
    13.922672702221394,
    14.204593198636742,
    14.486501505025068,
    14.768396332218838,
]

const THETA_DOUBLE = [
    2.22044604925031e-16,
    2.58095680299462e-08,
    1.38634786611912e-05,
    0.000339716883997683,
    0.00240087635788727,
    0.0090656564075951,
    0.0238445553250027,
    0.0499122887111532,
    0.0895776020322334,
    0.144182976161438,
    0.214235806845171,
    0.299615891381158,
    0.39977753363168,
    0.513914693612429,
    0.64108352330412,
    0.780287425662658,
    0.930532846078657,
    1.09086371929004,
    1.26038106064264,
    1.43825259680434,
    1.62371595023582,
    1.81607781621509,
    2.01471078094462,
    2.21904886936509,
    2.42858252444283,
    2.64285345745944,
    2.86144963393426,
    3.08400054498916,
    3.31017283989027,
    3.53966634874369,
    3.77221049568175,
    4.00756108611804,
    4.2454974425797,
    4.48581985944737,
    4.72834734579354,
    4.97291562619198,
    5.21937537108406,
    5.46759063052454,
    5.71743744757201,
    5.96880263004185,
    6.22158266168989,
    6.47568273607998,
    6.73101589838102,
    6.98750228213063,
    7.24506842959795,
    7.50364668578886,
    7.76317465737799,
    8.02359472893998,
    8.28485362980392,
    8.54690204568493,
    8.80969426997132,
    9.07318789017615,
    9.33734350561201,
    9.60212447282656,
    9.8674966757534,
    10.1334283178975,
    10.399889734191,
    10.6668532204341,
    10.9342928784758,
    11.2021844755046,
    11.4705053160025,
    11.7392341250802,
    12.0083509420532,
    12.2778370232469,
    12.5476747531264,
    12.8178475629466,
    13.0883398562033,
    13.3591369402429,
    13.630224963455,
    13.9015908575319,
    14.1732222843318,
    14.4451075869313,
    14.7172357444901,
    14.9895963305943,
    15.2621794747717,
    15.5349758269057,
    15.8079765243009,
    16.081173161174,
    16.3545577603693,
    16.6281227471121,
    16.9018609246349,
    17.1757654515241,
    17.4498298206474,
    17.7240478395392,
    17.9984136121263,
    18.2729215216918,
    18.5475662149805,
    18.822342587359,
    19.0972457689506,
    19.3722711116726,
    19.6474141771086,
    19.9226707251543,
    20.1980367033831,
    20.4735082370831,
    20.7490816199359,
    21.0247533053561,
    21.3005198986635,
    21.5763781507214,
    21.8523249549901,
    22.1283573534646,
]

function coefficients(tol)
    tol ≥ 2^(-10) && return THETA_HALF
    tol ≥ 2^(-24) && return THETA_SINGLE
    tol ≥ 2^(-53) && return THETA_DOUBLE
    return throw(DomainError(tol, "Tolerance less than 2^(-53) is unsupported."))
end
